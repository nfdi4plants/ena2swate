<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" charset="utf-8" name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="ENA Checklist to SWATE template">
		<meta name="keywords" content="ENA, checklist, template, SWATE">
    <meta charset="utf-8"/>
    <title>ENA checklists to SWATE template</title>
    <link href="css/bootstrap.min.css" rel="stylesheet"/>
    <link href="css/custom.css" rel="stylesheet"/>
    <script src="js/bootstrap.bundle.min.js" type="text/javascript" charset="utf-8"> </script>	
    <style>
      .smallRef{
        font-size: 0.7rem;
        line-height: 0.9rem;
      }
      .description{
        font-size: 0.9rem;
        line-height: 1.1rem;
      }
      button:disabled{
          border: 1px solid #999999 !important;
          background-color: #377d98 !important;
          opacity:1 !important;
          color: #FFFFFF !important;
        }
        table{
          table-layout: fixed;
        }
        th,
        td {
          border: 1px solid black;
          #width: 20vw !important;
          overflow: hidden;
        }
		</style>
  </head>
  <body class="d-grid gap-3" style="background: rgb(45, 62, 80, 0.2); " >
    <script>
      var spreadsheet;
   var ENAsample, ENAsequence, ENAread, samplesChecklist, dataAnalysesChecklist, checklistNo, spreadsheet ;
     var ENAall = [ENAsample, ENAread, ENAsequence];
     const ENAURL = [`https://wwwdev.ebi.ac.uk/ena/submit/report/checklists/xml/*?type=sample`,
  `https://wwwdev.ebi.ac.uk/ena/submit/report/checklists/getReadFields`,
  `https://wwwdev.ebi.ac.uk/ena/submit/report/checklists/xml/*?type=sequence`
]
      
function loadTemplate(){
document.getElementById("UploadFiles_MainWindowInit")
}
var googleJSON;

function csvJSON(csv){

  var lines=csv.split("\n");

  var result = [];
  var headers=lines[0].split(",");

  for(var i=1;i<lines.length;i++){

      var obj = {};
      var currentline=lines[i].split(",");

      for(var j=0;j<headers.length;j++){
          obj[headers[j]] = currentline[j];
      }

      result.push(obj);

  }

  //return result; //JavaScript object
  return JSON.stringify(result); //JSON
  }

async function fetchGoogleCSV(){
    try {
      //read .csv file on a server
      const target = `https://docs.google.com/spreadsheets/d/e/2PACX-1vSelJd6uBG8Ri_vqoxawVbCmy4U5Lvc1vqwOFo7dgBz1_yWOuosL46aG9dZdIB7RvuCOzW5Vnr3ytck/pub?gid=82880550&single=true&output=csv`;

      const res = await fetch(target, {
      
          method: 'get',
          headers: {
            
              'content-type': 'text/csv;charset=UTF-8',
          }
      });

      if (res.status === 200) {
          const data = await res.text();
          googleJSON =JSON.parse(csvJSON(data));
          //document.getElementById("submission").disabled = false;

      } else {
          console.log(`Error code ${res.status}`);
      }
    } catch (err) {
      console.log(err)
  }

}

fetchGoogleCSV();

function enaTerm2Ont(termName, id1="1" ,listId="all" ){
  //console.log("termName is: " + termName)
  for (const [index,element] of Object.entries(googleJSON)){
    //console.log("Field Name is: " + element["Field Name"]);
    if ((termName=="5\'_PARTIAL")||(termName=="3\'_PARTIAL") ){
      
      var condition = (element["Field Name"] == termName)&&((element["Checklist"] == id1+":"+listId) );
    } else {
      var condition = (element["Field Name"] == termName) ;
    }


    if (condition)
    {
      //console.log("found 5\'_PARTIAL ontology: " +termName+ element.id);
      return element.id;
      
    }else{
      
    }
  }
  console.log("did not found ontology: ")
      return "";
}

  async function fetchENAXML(ENAall, ENAURL){
    for (const [index, url] of ENAURL.entries()){ 
      try {
        //read xml and json from ENA server
        const target = url;
        const res = await fetch(target, {           
            method: 'get',
            headers: {                
                'content-type': 'text/xml;charset=UTF-8',
            }
        });
        if (res.status === 200) {
            const data = await res.text();
            
            ENAall[index] = data;
            //document.getElementById("submission").disabled = false;

        } else {
            console.log(`Error code ${res.status}`);
        }
      } catch (err) {
          console.log(err)
        }
    }
  }     
  fetchENAXML( window.ENAall, ENAURL)
      .then(()=>{
        var parser = new DOMParser();
        window.ENAall[0] = parser.parseFromString(window.ENAall[0],"text/xml");
        window.ENAall[2] = parser.parseFromString(window.ENAall[2],"text/xml");
        window.ENAall[1] = JSON.parse(window.ENAall[1]).fieldTypes;

        //saveData(xlsxbuffer, "a.xlsx");
      }
    ).then(()=>{
      
      document.getElementById("samplesColumn").outerHTML= template(0, "samples");
      document.getElementById("sTemplate").disabled = false;

      document.getElementById("rawReadsColumn").outerHTML= templateJSON(1, "raw reads");
      document.getElementById("rrTemplate").disabled = false;

      document.getElementById("dataAnalysesColumn").outerHTML= template(2, "data analyses");
      document.getElementById("daTemplate").disabled = false;

    })
    .catch(err => {console.log("fetch of ena xml failed, error is ", err)})



  function ena2ont(id1= 0, checklistNr="ERC000037"){
  checklistNr=  checklistNr==""?  "ERC000037":checklistNr; 
  var linkList = document.createElement('div');
 
  const checklists1 = ENAall[id1].evaluate(
      "//CHECKLIST",
      ENAall[id1],
      null,
      XPathResult.ANY_TYPE,
      null,
    );
      
      var list1 = checklists1.iterateNext();
      var number = 0;
      let header =`
      format-version: 1.4
      data-version: 0.1
      date: 03:07:2024 12:00
      saved-by: xiaoranzhou
      auto-generated-by: ena2ont
      subsetdef: sample "CHECKLIST SET for samples"
      subsetdef: rawread "CHECKLIST SET for rawreads"
      subsetdef: sample "CHECKLIST SET for sequences"
      treat-xrefs-as-equivalent: MIAPPE
      treat-xrefs-as-equivalent: NCBITaxon
      treat-xrefs-as-equivalent: NCIT
      treat-xrefs-as-equivalent: NFDI4PSO
      !remark: coverage: ENA checkilist definition
      !remark: creator: Xiaoran Zhou <x.zhou<-at->fz-juelich.de>
      !remark: curator: Xiaoran Zhou <x.zhou<-at->fz-juelich.de>
      !remark: first tree numbers of the IDs are checklsit numbers, and last 4 numbers are the term ids
      ontology: enacl
      `;

      let mandatoryDict = {
        "mandatory" : "ENACL:1000001",
        "recommended" : "ENACL:1000002",
        "optional" : "ENACL:1000003"
      }

      while ((list1 != undefined)){
        var checklistNo = list1.getAttribute("accession");
        console.log("number "+ checklistNr +" accession is "+ checklistNo);
      if (checklistNr == checklistNo){
      number +=1;
      let Term1 =`
[Term]
id: ENACL:0`+checklistNo.slice(2)+`
name: `+checklistNo+`
def: " `+list1.querySelector("DESCRIPTOR").querySelector("LABEL").innerHTML+`"
      
[Typedef]
id: ENACL:1000001
name: Mandatory
def: " Must exist in the metadata. The validation will fail if the term or an Xref term does not exist."
[Typedef]
id: ENACL:1000002
name: Recommended
def: " Recommended to be in the metadata. The validation will give warnings if the term or an Xref term does not exist."
[Typedef]
id: ENACL:1000003
name: Optional
def: " Optional in the metadata. The validation will only log the information, if the term or an Xref term does not exist."
      `
      const list2 = Array.prototype.slice.call(list1.querySelectorAll("FIELD"));
      var text = header + Term1;
        for (const [index, element] of Object.entries(list2) ){
          const label = element.querySelector("LABEL").innerHTML;
          const description = element.querySelector("DESCRIPTION").innerHTML;
          const mandatory = element.querySelector("MANDATORY").innerHTML;
          var units;
          const ontId = enaTerm2Ont(label, id1, checklistNo);
          try{
             units = element.querySelector("UNITS").querySelector("UNIT").innerHTML;
          }catch(e){units = "no unit"; }
          var fieldType
          try{
          fieldType = element.querySelector("FIELD_TYPE").childNodes[1].nodeName;
          }catch(e){fieldType = " "; console.log("no field type", e)}
          var fieldValidate;
          try{
          fieldValidate = element.querySelector("FIELD_TYPE").innerHTML.toString();
          }catch(e){fieldValidate = " "}
        //console.log("csv will be: "+ label+", "+ mandatory+", "+ units+", "+fieldType+", "+fieldValidate );
        let ontid = "ENACL:" + (100+parseInt(number)).toString()+ (1000+parseInt(index)).toString();
        let xrefOnt = ontId ? `
xref: `+ ontId : {}; 
        text += `
[Term]
id: `+ontid+`
name: `+label+`
comment: `+ "\t mandatory: "+ mandatory+".\t unit:"+ units+".\t field type: "+fieldType+".\t validation: "+fieldValidate.replaceAll(/(?:\r\n|\r|\n)/g, "").replace(/(?:\r\n|\r|\n)/g, "").replaceAll("{","\\{").replaceAll("}","\\}")+`
subset: samples
def: " `+description.replaceAll('"','\\"')+`"`+xrefOnt+`
relationship: `+mandatoryDict[mandatory] +  ` ENACL:0`+checklistNo.slice(2)+"\n";
        
       // label+"\t"+ mandatory+"\t"+ units+"\t"+fieldType+"\t"+fieldValidate.replace(/(?:\r\n|\r|\n)/g, "").replace(/(?:\r\n|\r|\n)/g, "")+"\n"
        


      }
        var element2 = document.createElement('a');
        element2.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element2.setAttribute('download', checklistNo+"_validation_info.obo" );

        element2.style.display = 'none';
        document.body.appendChild(element2);
      
        //element2.click();
        linkList.appendChild(element2);
        //console.log(linkList);
      }
        list1 = checklists1.iterateNext();
      
  }
  
  const listArray = Array.prototype.slice.call(linkList.querySelectorAll("a"));
  //console.log(listArray);
  //listArray[0].click();
  for (const [ id, link] of Object.entries(listArray)){
    //console.log("id "+id+ " "+link)
    setTimeout(function() {
      link.click();
    }, 500+500* parseInt(id));

  }
  
    
}



    
function ena2csv(id1){
  var linkList = document.createElement('div');
 
  const checklists1 = ENAall[id1].evaluate(
      "//CHECKLIST",
      ENAall[id1],
      null,
      XPathResult.ANY_TYPE,
      null,
    );
      
      var list1 = checklists1.iterateNext();
      var number = 0;
      while (list1 != undefined){
      var checklistNo = list1.getAttribute("accession");
      number +=1;
      console.log("number "+ number +"accession is "+ checklistNo);
      const list2 = Array.prototype.slice.call(list1.querySelectorAll("FIELD"));
      var text = "label\tmandatory2\tunits\tfieldType\tfieldValidate\n";
        for (const [index, element] of Object.entries(list2) ){
          const label = element.querySelector("LABEL").innerHTML;
          const mandatory = element.querySelector("MANDATORY").innerHTML;
          var units;
          try{
             units = element.querySelector("UNITS").querySelector("UNIT").innerHTML;
          }catch(e){units = "no unit"; }
          var fieldType
          try{
          fieldType = element.querySelector("FIELD_TYPE").childNodes[1].nodeName;
          }catch(e){fieldType = " "; console.log("no field type", e)}
          var fieldValidate;
          try{
          fieldValidate = element.querySelector("FIELD_TYPE").innerHTML.toString();
          }catch(e){fieldValidate = " "}
        //console.log("csv will be: "+ label+", "+ mandatory+", "+ units+", "+fieldType+", "+fieldValidate );
        text += label+"\t"+ mandatory+"\t"+ units+"\t"+fieldType+"\t"+fieldValidate.replace(/(?:\r\n|\r|\n)/g, "").replace(/(?:\r\n|\r|\n)/g, "")+"\n"
        


    }
        var element2 = document.createElement('a');
        element2.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element2.setAttribute('download', checklistNo+"_validation_info.tsv" );

        element2.style.display = 'none';
        document.body.appendChild(element2);
      
        //element2.click();
        linkList.appendChild(element2);
        //console.log(linkList);
        list1 = checklists1.iterateNext();
  }
  
  const listArray = Array.prototype.slice.call(linkList.querySelectorAll("a"));
  //console.log(listArray);
  //listArray[0].click();
  for (const [ id, link] of Object.entries(listArray)){
    //console.log("id "+id+ " "+link)
    setTimeout(function() {
      link.click();
    }, 500+500* parseInt(id));

  }
  
    
}


function enaJSON2csv(id1=1){
  var linkList = document.createElement('div');
 
  const checklists1 = ENAall[id1]
      
    for (const lists of checklists1){
      var text = "label\tmandatory\tvalueChoice\n";
      var listName = lists.name;
      console.log(listName);
      for (const list1 of lists.fields) 
      {
        const label = list1.name;
        const mandatory = list1.mandatory;
        const valueChoice = list1.value_choice;

        //console.log("csv will be: "+ label+", "+ mandatory+", "+ units+", "+fieldType+", "+fieldValidate );
        text += label+"\t"+ mandatory+"\t"+valueChoice+"\n"
        //console.log(text);
      }
      var element2 = document.createElement('a');
        element2.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
        element2.setAttribute('download', listName+"_validation_info.tsv" );

        element2.style.display = 'none';
        document.body.appendChild(element2);
      
        //element2.click();
        linkList.appendChild(element2);
        console.log(linkList);
      }
      const listArray = Array.prototype.slice.call(linkList.querySelectorAll("a"));
  console.log(listArray);
  //listArray[0].click();
  for (const [ id, link] of Object.entries(listArray)){
    console.log("id "+id+ " "+link);
    setTimeout(function() {
      link.click();
    }, 500+500* parseInt(id));

}
       
    }

  
    




// -------- 1. Create and manipulate object in datamodel ----------
function template(id1, listName){
  //<label for="checkDataList" class="form-label">checklist </label> 
    let HTMLtext = `<input class="form-control" list="datalistOptions`+id1+`" id="checkDataList`+id1+`" placeholder="Type to search `+listName+` checklist...">
    <datalist id="datalistOptions`+id1+`">
    `;
    const checklists = ENAall[id1].evaluate(
      "//CHECKLIST",
      ENAall[id1],
      null,
      XPathResult.ANY_TYPE,
      null,
    );
    
    var list1= checklists.iterateNext() ;
    while (list1 != null )
    {       
      const checkid = list1.getAttribute("accession");
      const name = list1.getElementsByTagName('DESCRIPTOR')[0].getElementsByTagName('NAME')[0].innerHTML;
      //console.log(name);
      HTMLtext +=   `<option name="`+id1+`" id="`+checkid +`" value="`+checkid+" "+name+`" >` ;
      list1 = checklists.iterateNext();
      
    }
    HTMLtext += "</datalist>"; 
    return HTMLtext;

  }
  function templateJSON(id1, listName){
  //<label for="checkDataList" class="form-label">checklist </label> 
    let HTMLtext = `<input class="form-control" list="datalistOptions`+id1+`" id="checkDataList`+id1+`" placeholder="Type to search `+listName+` checklist...">
    <datalist id="datalistOptions`+id1+`">
    `;
    const checklists = ENAall[id1];
    
    
    for (const [index, element] of Object.entries(checklists) )
    {       
      const checkid = index;
      const name = element.name;
      //console.log(name);
      HTMLtext +=   `<option name="`+id1+`" id="`+checkid +`" value="`+name+": "+element.label+`" >` ;
      
      
    }
    HTMLtext += "</datalist>"; 
    return HTMLtext;

  }




  var saveData = (function () {
      var a = document.createElement("a");
      document.body.appendChild(a);
      a.style = "display: none";
      return function (xlsxbuffer, fileName) {
          
          const blob = new Blob([xlsxbuffer]),
              url = window.URL.createObjectURL(blob);
          a.href = url;
          a.download = fileName;
          a.click();
          window.URL.revokeObjectURL(url);
      };
  }());


  function checkInput(checkName, id1){
    var selected = []; 
    document.querySelectorAll("input[name="+checkName+"]").forEach((ele)=> {if(ele.checked){ selected.push(ele.value)  }}  ); 
    //console.log(selected);
    if (document.getElementById("checkDataList"+id1).value == ""){

      return alert("The checklist name is not selected, please select")
      }

    const value = document.getElementById("checkDataList"+id1).value;
    window.checklistNo = document.querySelector('option[name="'+id1+'"][value="'+value+'"]').id;
    const checklists = ENAall[id1].evaluate(
      "//CHECKLIST[@accession='"+ checklistNo+"']",
      ENAall[id1],
      null,
      XPathResult.ANY_TYPE,
      null,
    );
    const list1 = checklists.iterateNext();
    var tableHTML1 = `
      <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">Term Name</th>
              <th scope="col">Term Type</th>
              <th scope="col">Requirement</th>
              <th scope="col">Ontology</th>
              <th scope="col">Export</th>
            </tr>
          </thead>
          <tbody>` ;
    const list2 = Array.prototype.slice.call(list1.querySelectorAll("FIELD"));
        for (const [index, element] of Object.entries(list2) ){
          const label = element.querySelector("LABEL").innerHTML;
          const mandatory = element.querySelector("MANDATORY").innerHTML;
          const include = (ele)=> ele === mandatory;
          if (selected.some(include))
          {
            //console.log(element.innerHTML)
            
            const ontId = enaTerm2Ont(label, id1, checklistNo);
            
            tableHTML1 += `<tr>
              <th name="LABEL" scope="row">`+label+`</th>
              <td>
                <select class="form-select" name="type" aria-label="characteristic or factor">
                  <option value="characteristic" selected> Characteristic (default) </option>
                  <option value="component">Component</option>
                  <option value="factor">Factor</option>
                  <option value="parameter">Parameter</option>
                  
                  <!--<option value="protocolType">protocolType</option>
                  <option value="protocolDescription">protocolDescription</option>
                  <option value="protocolUri">protocolUri</option>
                  <option value="protocolVersion">protocolVersion</option>
                  <option value="protocolREF">protocolREF</option>
                  <option value="performer">performer</option>
                  <option value="date">date</option>
                  <option value="input">input</option>
                  <option value="output">output</option>
                  <option value="freeText">freeText</option>-->

                </select>
                
                </td>
              <td name="MANDATORY">`+mandatory+`</td>
              <td name="ontId">`+ontId+`</td>
              <td>
                <div class="form-check">
                <input class="form-check-input" type="checkbox" name="modalTableList`+id1+`" id="`+label+`checkbox" checked>
                <label class="form-check-label" for="`+label+`checkbox" >
                
                </label>
                </div>
              </td>
              </tr>`;

          }

        }

      tableHTML1 += "</tbody> </table>";
      //console.log(tableHTML1);
      document.getElementById("modal"+id1+"body").innerHTML= tableHTML1;
      //callback(id1,selected);
          document.getElementById("modal"+id1+"button").click();
  }
  function listJSONFields(){
    var uniqueList = {}
    var csv = "";
    for (const [index1, element1] of Object.entries( ENAall[1])){
        //console.log(element1);
        for (const [index2, element2] of Object.entries( element1.fields)){
            try {
                uniqueList[element2.name];
                if (uniqueList[element2.name][1] == element2.description){
                  
                }else {
                    console.log("term ---"+element2.label +" ---exists but the descriptions are not the same. previous description is: "+uniqueList[element2.name][1]+"\n current is: "+ element2.description)
                }
                
            } catch (error) {
                var newRow = [element2.label, element2.description, element2.mandatory, element2.label ];
                uniqueList[element2.name] = newRow;
                //console.log("added dict: "+ uniqueList[element2.name]);
                csv += newRow[0]+"\t"+newRow[1]+"\t"+newRow[2]+"\n";
            }
            
        }    
    }
    window.location.href = "data:text/tab-separated-values," + encodeURIComponent(csv);
    return csv;
  }


  function listXMLFields(id1){
    var uniqueList = {}
    var tsv = "";
    var tsvCompare = "";
    const checklists = ENAall[id1].evaluate(
      "//CHECKLIST",
      ENAall[id1],
      null,
      XPathResult.ANY_TYPE,
      null,
    );
    
    var list1= checklists.iterateNext() ;
    while (list1 != null )
    {       
      const checkid = list1.getAttribute("accession");
      const name = list1.getElementsByTagName('DESCRIPTOR')[0].getElementsByTagName('NAME')[0].innerHTML;
      const allField = Array.from(list1.querySelectorAll("FIELD"));

        for (const [index2, element2] of Object.entries( allField)){
            const name =element2.querySelector("LABEL").innerHTML;
            const label =element2.querySelector("LABEL").innerHTML;
            const mandatory =element2.querySelector("MANDATORY").innerHTML;
            const description =element2.querySelector("DESCRIPTION").innerHTML
            try {
                
                uniqueList[name];
                if (uniqueList[name][1] == description){
                  
                }else {
                    console.log("term in ---"+label +" --- exists but the descriptions are not the same. previous description is: "+uniqueList[name][1]+"\n current is: "+ description)
                    tsvCompare += uniqueList[name][0]+"\t"+uniqueList[name][3]+"\t"+uniqueList[name][1]+"\t"+checkid+ "\t" + description+"\n";
                  }
                
            } catch (error) {

                var newRow = [label, description, mandatory, id1+":"+checkid];
                uniqueList[name] = newRow;
                //console.log("added dict: "+ uniqueList[name]);
                tsv += newRow[0]+"\t"+newRow[1]+"\t"+newRow[2]+"\t"+newRow[3]+"\n";
            }
            
        }    
        list1 = checklists.iterateNext();
    }
    var link = document.createElement('a');
    window.location.href = "data:text/tab-separated-values," + encodeURIComponent(tsv);
    //window.location.href = "data:text/tab-separated-values," + encodeURIComponent(tsvCompare);
    return tsv;
  }

  function checkJSONInput(checkName, id1){
    var selected = []; 
    document.querySelectorAll("input[name="+checkName+"]").forEach((ele)=> {if(ele.checked){ selected.push(ele.value)  }}  ); 
    //console.log(selected);
    if (document.getElementById("checkDataList"+id1).value == ""){

      return alert("The checklist name is not selected, please select")
      }

    const value = document.getElementById("checkDataList"+id1).value;
    window.checklistNo = document.querySelector('option[name="'+id1+'"][value="'+value+'"]').id;
    const list1 = ENAall[id1][checklistNo];
    var tableHTML1 = `
      <table class="table table-striped table-hover">
          <thead>
            <tr>
              <th scope="col">Term Name</th>
              <th scope="col">Term Type</th>
              <th scope="col">Mandatory</th>
              <th scope="col">Ontology</th>
              <th scope="col">Export</th>
            </tr>
          </thead>
          <tbody>` ;
    const list2 = list1.fields;
        for (const [index, element] of Object.entries(list2) ){
          const label = element.label;
          const mandatory = element.mandatory? "mandatory": "optional" ;
          const include = (ele)=> ele === mandatory;
          if (selected.some(include))
          {
            //console.log(element.innerHTML)
            
            const ontId = enaTerm2Ont(label);
            
            tableHTML1 += `<tr>
              <th name="LABEL" scope="row">`+label+`</th>
              <td>
                <select class="form-select" name="type" aria-label="characteristic or factor">
                  <option value="characteristic" selected> Characteristic (default) </option>
                  <option value="component">Component</option>
                  <option value="factor">Factor</option>
                  <option value="parameter">Parameter</option>
                  
                  <!--<option value="protocolType">protocolType</option>
                  <option value="protocolDescription">protocolDescription</option>
                  <option value="protocolUri">protocolUri</option>
                  <option value="protocolVersion">protocolVersion</option>
                  <option value="protocolREF">protocolREF</option>
                  <option value="performer">performer</option>
                  <option value="date">date</option>
                  <option value="input">input</option>
                  <option value="output">output</option>
                  <option value="freeText">freeText</option>-->

                </select>
                
                </td>
              <td name="MANDATORY">`+mandatory+`</td>
              <td name="ontId">`+ontId+`</td>
              <td>
                <div class="form-check">
                <input class="form-check-input" type="checkbox" name="modalTableList`+id1+`" id="`+label+`checkbox" checked>
                <label class="form-check-label" for="`+label+`checkbox" >
                
                </label>
                </div>
              </td>
              </tr>`;

            

          }


        }

      tableHTML1 += "</tbody> </table>";
      //console.log(tableHTML1);
      document.getElementById("modal"+id1+"body").innerHTML= tableHTML1;

           
      
      
      //callback(id1,selected);
          document.getElementById("modal"+id1+"button").click();
  }
   </script>
   <script src="js/main.js"></script>
   <div class="row" style="background: rgb(45, 62, 80); height: 3.25rem; margin: 0 0 0 0px; padding: 0 0 0 0; ">
    <a class="" href="https://nfdi4plants.org/" >
      <img src="images/logo.png" alt="Logo" width="32" height="32" style="position: absolute; margin: 8px 12px 8px 12px; left: 0px; padding-top: 0px;" />
    </a>
    
    <div class="justify-content-center row d-flex align-items-center" style="margin: 0 0 0 0; ; padding: 0 0 0 0; height: 3.25rem;  ">
      <div class="btn-group d-md-none g-0 dropdown col-auto d-flex align-items-center" >
        <button type="button" class="btn rounded-0 border-0 g-0 btn-nav " data-bs-toggle="dropdown" aria-expanded="false" id="menu">
          Menu &nbsp;
          <span style="display: inline-block; color: rgb(79, 179, 217); letter-spacing: 2px; font-size: 1em; transform: scaleX(2); transform-origin: 1 0;"> ∨ </span>
        </button>
        <ul class="dropdown-menu">
        <li>
            <a id="metadata1" class="dropdown-item" target=”_blank” href="https://github.com/xiaoranzhou/ena2swate">github source code</a>
          </li>
          <li>
            <a id="Ontology" class="dropdown-item d-none" target=”_blank” href="https://docs.google.com/spreadsheets/d/1h6nOgM0NHYJFwNEbiKgqNIbHF1UE2NoEFw1SqVD29Yw">Ontology Mapping</a>
          </li>  
          <li>
            <a id="obo" class="dropdown-item" target=”_blank” onclick="ena2ont(0, document.getElementById('checkDataList0').value.split(' ')[0])" >download obo</a>
          </li>         
        </ul>
      </div>

      <div class="btn-group d-none g-0 d-md-block dropdown col-auto"  >
        <button type="button" class="btn border-0 rounded-0 g-0 btn-nav" data-bs-toggle="dropdown" aria-expanded="false" id="metadataMenu" >
          Menu &nbsp;

          <span style="display: inline-block; color: rgb(79, 179, 217); letter-spacing: 2px; font-size: 1em; transform: scaleX(2); transform-origin: 1 0;"> ∨ </span>
        </button>
        <ul class="dropdown-menu" >
          <li>
            <a id="metadata2" class="dropdown-item" target=”_blank” href="https://github.com/xiaoranzhou/ena2swate">github source code</a>
          </li>
          <li>
            <a id="obo" class="dropdown-item" target=”_blank” onclick="ena2ont(0, document.getElementById('checkDataList0').value.split(' ')[0])" >download obo</a>

          </li>
                          
        </ul>
      </div>

      
    </div>
  </div>
  <div class="container text-center ">
  <div class="row justify-content-center">
    <h2>Generate SWATE template from ENA checklists </h2>
    <h6>ENA has three checklist types, namely samples, raw reads and data analyses. By search and selecting a checklist, a Swate template can be created. </h6>
    <div class="col-8">
      <div class="row mb-5" id="row1">
        <h4> Samples </h4>
        <div class="input-group mb-3 " >
          <div id="samplesColumn"> not fetched</div>
          <div class="input-group-text">
            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="sampleM" name="sampleCheck" role="switch" value="mandatory" aria-label="Radio button for previous datalist" checked>
            <label class="form-check-label" for="sampleM" >Mandatory&nbsp;</label>
          </div>
            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="sampleR" name="sampleCheck" role="switch" value="recommended" aria-label="Radio button for previous datalist">
            <label class="form-check-label" for="sampleR">Recommended&nbsp;</label>
          </div>
            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="sampleO" name="sampleCheck" role="switch" value="optional" aria-label="Radio button for previous datalist">
            <label class="form-check-label" for="sampleO">Optional&nbsp;</label>
          </div>
          </div>
          
        </div>
        <div class="row" id="row1.5">
          <div class="d-flex justify-content-center">                   
            <button type="button" id="sTemplate" class="btn btn-primary btn-lg" onclick='checkInput("sampleCheck", 0); '  disabled>Download ENA Samples Template</button> 
          </div>
        </div>
      </div>
      <div class="row mb-5" id="row2">
        <h4> Raw Reads </h4>
        <div class="input-group mb-3" >
          <div id="rawReadsColumn"> not fetched</div>
          <div class="input-group-text">
            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="rawReadsM" name="rawReadsCheck" role="switch" value="mandatory" aria-label="Radio button for previous datalist" checked>
            <label class="form-check-label" for="rawReadsM" >Mandatory&nbsp;</label>
          </div>

            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="rawReadsO" name="rawReadsCheck" role="switch" value="optional" aria-label="Radio button for previous datalist">
            <label class="form-check-label" for="rawReadsO">Optional&nbsp;</label>
          </div>
          </div>
          
        </div>
        <div class="row" id="row2.5">
          <div class="d-flex justify-content-center">                   
            <button type="button" id="rrTemplate" class="btn btn-primary btn-lg" onclick='checkJSONInput("rawReadsCheck", 1);'  disabled>Download ENA Raw Reads Template</button> 
          </div>
        </div>
      </div>
      <div class="row mb-5" id="row3">
        <h4> Data Analyses </h4>
        <div class="input-group mb-3 " >
          <div id="dataAnalysesColumn"> not fetched</div>
          <div class="input-group-text">
            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="dataAnalysesM" name="dataAnalysesCheck" role="switch" value="mandatory" aria-label="Radio button for previous datalist" checked>
            <label class="form-check-label" for="dataAnalysesM" >Mandatory&nbsp;</label>
          </div>

            <div class="form-check form-switch">
            <input class="form-check-input" type="checkbox" id="dataAnalysesO" name="dataAnalysesCheck" role="switch" value="optional" aria-label="Radio button for previous datalist">
            <label class="form-check-label" for="dataAnalysesO">Optional&nbsp;</label>
          </div>
          </div>
          
        </div>
        <div class="row" id="row3.5">
          <div class="d-flex justify-content-center">                   
            <button type="button" id="daTemplate" class="btn btn-primary btn-lg" onclick='checkInput("sampleCheck", 2);'  disabled>Download ENA Data Analyses Template</button> 
          </div>
        </div>
      </div>
    </div>
    </div>
  </div>


<!-- Button trigger Samples modal -->
<button type="button" class="btn btn-primary d-none" id="modal0button" data-bs-toggle="modal" data-bs-target="#modal0">
  Launch demo modal
</button>

<!--Samples Modal -->
<div class="modal modal-xl fade" id="modal0" tabindex="-1" aria-labelledby="modal0Label" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="Modal0Label">Select Terms From the Checklist</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="modal0body">




      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary" onclick="downloadTemplate( 0,samplesTemplate)">Download SWATE Template</button>
        <button type="button" class="btn btn-primary" onclick="swateLoadTemplate(0,samplesTemplate)" id="swateModalbutton" data-bs-toggle="modal" data-bs-target="#swateModal">
          Launch template in swate
        </button>
      </div>
    </div>
  </div>
</div>


<!-- Button trigger Samples modal -->


<!--swate Modal -->
<div class="modal fade" id="swateModal" tabindex="-1" data-backdrop="static" aria-labelledby="swateModalLabel" aria-hidden="true" >
  <div class="modal-dialog " style="height:90vh">
    <div class="modal-content" style="width:98vw;height:98vh;   position: absolute;top: 50%;left: 50%;transform: translate(-50%, -50%);">
      <div class="modal-header">
        <h1 class="modal-title fs-5" id="Modal0Label">Swate-alpha</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="modal0body"  style="height:90vh">
        <iframe src="https://swate-alpha.nfdi4plants.org/" id="swateFrame" onload="loadTemplate(this)" width="100%" height="100%" frameborder="0" sandbox="allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation"
                        allowtransparency="true"></iframe>



      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary d-none" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary d-none" onclick="samplesTemplate(0)">Download SWATE Template</button>
      </div>
    </div>
  </div>

</div>

  <!-- Button trigger Raw Reads modal -->
  <button type="button" class="btn btn-primary d-none" id="modal1button" data-bs-toggle="modal" data-bs-target="#modal1">
    Data Analyses
  </button>
  
  <!-- Data Raw Reads Modal -->
  <div class="modal modal-xl fade" id="modal1" tabindex="-1" aria-labelledby="modal1Label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="Modal1Label">Select Terms From the Checklist</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modal1body">
  
  
  
  
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onclick="downloadTemplate( 1,samplesTemplate)">Download SWATE Template</button>
          <button type="button" class="btn btn-primary" onclick="swateLoadTemplate(1,samplesTemplate)" id="swateModalbutton" data-bs-toggle="modal" data-bs-target="#swateModal">
               Launch template in swate
          </button>
        </div>
      </div>
    </div>
  </div>
  </body>
</html>



  <!-- Button trigger Data Analyses modal -->
  <button type="button" class="btn btn-primary d-none" id="modal2button" data-bs-toggle="modal" data-bs-target="#modal2">
    Data Analyses
  </button>
  
  <!-- Data Analyses Modal -->
  <div class="modal modal-xl fade" id="modal2" tabindex="-1" aria-labelledby="modal2Label" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="Modal2Label">Select Terms From the Checklist</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="modal2body">
  
  
  
  
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" onclick="downloadTemplate( 2,samplesTemplate)">Download SWATE Template</button>
          <button type="button" class="btn btn-primary" onclick="swateLoadTemplate(2,samplesTemplate)" id="swateModalbutton" data-bs-toggle="modal" data-bs-target="#swateModal">
             Launch template in swate
          </button>
        </div>
      </div>
    </div>
  </div>
  </body>
</html>